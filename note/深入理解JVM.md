# 深入理解JVM

* jconsole
* jvisualvm
* jmap

[TOC]

## 一、JVM 类加载机制

### 1、类加载

* 在Java代码中，类型的**加载**、**连接**与**初始化**过程都是在程序**运行期**间完成的
* 提供了更大的灵活性，增加了更多的可能性

### 2、类加载器

* Java虚拟机与程序的生命周期
* 在如下几种情况下，Java虚拟机将结束生命周期
  * 执行了System.exit()方法
  * 程序正常执行结束
  * 程序在执行过程中遇到了异常或者错误而异常终止
  * 由于操作系统出现错误而导致Java虚拟机进程终止

### 3、类的加载、连接与初始化

* 加载
  * 查找并加载类的二进制数据

* 连接
  * 验证：确保被加载的类的正确性
  * 准备：为类的**静态变量**分配内存，并将其初始化为**默认值**
  * 解析：把类中的符号引用转换为直接引用
    * 符号引用：符号引用以一组符号来描述所引用的目标，符号可以是任何形式的字面量，只要使用时能够无歧义的定位到目标即可
    * 直接引用：直接引用可以是
      * 1）直接指向目标的指针（比如，指向“类型”【Class对象】、类变量、类方法的直接引用可能是指向方法区的指针）
      * 2）相对偏移量（比如，指向实例变量、实例方法的直接引用都是偏移量）
      * 3）一个能间接定位到目标的句柄

* 初始化：**为类的静态变量赋予正确的初始值**

### 4、类的使用和卸载

* 使用
  * 当 JVM 完成初始化阶段之后，JVM 便开始从入口方法开始执行用户的程序代码
* 卸载
  * 当用户程序代码执行完毕后，JVM 便开始销毁创建的 Class 对象，最后负责运行的 JVM 也退出内存